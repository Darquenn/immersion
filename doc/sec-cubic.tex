\section{Cubic: degree=3}
\label{sec.cubic}

\subsection{Objectives}
The assignment in this section is:
\begin{enumerate}
\item Complete the file \code{src/cubic.py} by writing a Python
  function which computes and returns the x-intercepts of a curve
  equation is \[y=a x^3 + b x^2 + c x + d\,.\]
\item You'll need to replace all occurances of \code{raise NotImplementedError()}
  with correct python code which passes the tests.

\item Complete the file \code{src/search.py} by completing the function \\
  \code{search\_root\_right}
  which follows a similar pattern to that of \\
  \code{search\_root\_left} which you have all the code for.

\item Test the function in GitHub Codespaces by running the file\\
  \code{test/test\_cubic.py}.
\end{enumerate}

\subsection{Overview}

We wish to find the roots of the cubic polynomial given by $P(x) = a
x^3 + b x^2 + c x + d$.  We will do this by first finding
(approximating) a root, $r$, using a technique called \emph{binary
seach}.  Knowing root $r$, we know that $(x-r)$ is a factor of $a x^3
+ b x^2 + c x + d$.  Once $(x-r)$ is factored out of $a x^3 + b x^2 + c x + d$
what remains is a quadratic polynomial of the form $A x^2 + Bx + C$.
We can find the roots of the quadratic using the technique
explained in Section~\ref{sec.quadratic}, thus obtaining the roots of
the cubic polynomial.


\subsection{The Math}

A polynomial of degree 3 has the form $P(x) = a x^3 + b x^2 + c x +d$.
If $a=0$ than $P(x)$ is really a quadratic polynomial (degree 2)
and can be solved using the techniques described in
Section~\ref{sec.quadratic}.  Every polynomial of degree 3 with real
coefficients (for which $a\neq 0$) has at least one real root because
\begin{enumerate}
\item Either $\lim\limits_{x\to-\infty}P(x) = -\infty$ and $\lim\limits_{x\to\infty}P(x) = \infty$,
  \item Or $\lim\limits_{x\to-\infty}P(x) = \infty$ and $\lim\limits_{x\to\infty}P(x) = -\infty$.
\end{enumerate}


We have a two cubic equations plotted in Figure~\ref{fig.cubic}.

\begin{figure}
  \centering
\input{pfg-cubic}
  %
  \caption{Cubics}
  \label{fig.cubic}
\end{figure}

\begin{align*}
  P_1(x) &= x^3 - 4*x^2 - 2*x - 10\\
  P_2(x) = -P_1(x) &= -x^3 + 4*x^2 + 2*x + 10
\end{align*}

$P_1(x)$ exemplifies the \emph{standard} case where the leading coefficient is positive: $a>0$.
$P_2(x)$ exemplifies the alternate case where the leading coefficient is negative: $a<0$.
However, we notice that $P_1(x)$ and $-P_1(x)$ have the exact same roots, because if $P_2(x) = -P_1(x) = 0$,
then $P_1(x) = 0$.  Therefore, if $a<0$, we can simply find the roots of $-a x^3 -b x^2 - c x - d$;
\ie, we simply negate the coefficients and find the roots of the negated cubic polynomial.




Given a cubic polynomial and a root, $r$, we may factor the polynomial into
the product of a monomial $(x-r)$ and a quadratic polynomial.

If $P(x) = a x^3 + b x^2 + c x + d$ has a root at $x=$, then $P(r)=0$.
Consequently, $(x-r)$ is a factor of $a x^3 + b x^2 + c x + d$, and
$P(x) = (x-r)(A x^2 + B x + C)$ for some $A, B, C$.  Once $A$, $B$,
and $C$ have been found, then the two remaining roots can be found by
applying the quadratic formulat to $A x^2 + B x + C$.  So how can we
determine the values of $A$, $B$, and $C$ given the root $r$ and the
original coefficients $a$, $b$, $c$, and $d$?

We can determine the values of $A$, $B$, and $C$ by computing the quotient of
the two polynomials $\frac{a x^3 + b x^2 + c x + d}{x-r}$. One approach is to use synthetic division.

\medskip

\begin{tabular}{lllll}
  \hline
  $r$ ) & $a$ & $b$       & $c$              & $d$\\
        &     & $a r$     & $b r+a r^2$      & $c r + b r^2 + a r^3$\\
  \hline
        & $\underbrace{a}_{A}$\quad\quad & $\underbrace{b + a r}_{B}$ \quad\quad& $\underbrace{c + b r + a r^2}_{C}$\quad\quad & $\underbrace{d + c r + b r^2 + a r^3}_{\text{Remainder}}$
\end{tabular}

From this synthetic division we see that 
\begin{align*}
  \frac{P(x)}{x-r} &=   \frac{a x^3 + b x^2 + c x + d}{x-r} \\
  &= A x^2 + B x + C + \frac{d + c r + b r^2 + a r^3}{x-r}\\
  &= A x^2 + B x + C + \frac{P(r)}{x-r}\\
  &= A x^2 + B x + C + \frac{0}{x-r} & \text{; because $r$ is a root of $P(x)$}\\
  &= A x^2 + B x + C
\end{align*}
Where
\begin{align}
 A &= a\label{eq.6.A}\\
  B &= b + a r\nonumber\\
   &= b + A r\label{eq.6.B}\\
  C &= c + b r + a r^2\nonumber\\
  &= c + B r\label{eq.6.C}
\end{align}

But what about the remainder $d + c r + b r^2 + a r^3$? This remainder must be zero if indeed 
$P(x) = (x-r)(A x^2 + B x + C)$.  Is it?  Yes.
Notice that $d + c r + b r^2 + a r^3$ is exactly $P(r)$.  Furthermore sinced $r$ is a root,
then $P(r)=0$.
\subsection{The Programming}

Steps for computing roots of a cubic polynomial.

\begin{enumerate}
\item Assume the coefficients of $P(x) = a x^3 + b x^2 + c x + d$ are
  \code{a},  \code{b},  \code{c},  and~\code{d}.
\item If \code{a==0}, then delegate to the previous solution by
  calling \\
  \code{find\_quadratic\_roots} and returning its return
  value.  Be careful, \code{find\_quadratic\_roots} accepts 3 input
  parameters.
\item If $P(x)$ is of the form of $P_2(x)$ in Figure~\ref{fig.cubic},
  \ie, if $a<0$, then compute and return the roots of $-P(x)$.  To
  compute the roots of $-P(x)$ we simply return
  \code{find\_cubic\_roots(-a, -b, -c, -d)}.
\item Since $P(0) = d$, then we can easily evaluate the polynomial at $x=0$ to get its y-intercept.
  \begin{enumerate}
  \item If $d = 0$, then 0 is a root, $P(0) = 0$.
  \item If $d>0$ then there is a root on the negative x-axis.  Find it with a binary search.
  \item If $d<0$ then there is a root on the positive x-axis. Find it with a binary search.
  \end{enumerate}
\item See Section~\ref{sec.binary.search} to explain the binary search.
\item Once the root $r$ is found, this means $(x-r)$ factors out $P(x)$. \Ie,
  ${P(x) = (x-r)(A x^2 + B x + C)}$.  The formulas for $A$, $B$, and $C$ can be found
  in Equations~\eqref{eq.6.A}, \eqref{eq.6.B}, and~\eqref{eq.6.C}.
\item The roots of the cubic are \code{[r]} concatenated to the roots of the quadratic 
  $A x^2 + B x + C$, which you can compute using the techniques in Section~\ref{sec.quadratic}.
\end{enumerate}


\subsection{Find a root using Binary Search}
\label{sec.binary.search}


\begin{figure}
  \centering
\input{pfg-cubic-binary1}
  %
  \caption{Expanding Binary Search} 
  \label{fig.cubic.binary}
\end{figure}

Consider the graph of the cubic polynomial shown in Figure~\ref{fig.cubic.binary}.  We'd like to
iteratively find a root; we will use the following steps.

\begin{enumerate}
\item If $P(0)=0$, then we know the root, $x=0$.
\item \label{step.2} If $P(0)< 0$, then find a value of $x_{upper}$ (to the right of 0, $x_{upper}>0$) such that either $P(x_{upper})>0$.
  Now take $x_{lower}=0$.
  Thus we
  will know there is a root in the interval $[x_{lower}, x_{upper}]$.
\item \label{step.3} If $P(0)> 0$, then find a value of $x_{lower}$ (to the left of 0, $x_{lower}<0$) such that either $P(x_{lower})<0$. 
  Now take $x_{upper}=0$.
 Thus we
  will know there is a root in the interval $[x_{lower}, x_{upper}]$.
\item \label{step.4} Since we know there is a root in the interval
  $[x_{lower}, x_{upper}]$, we can divide the interval into two
  intervals.  With the midpoint of the interval, \[x_{mid} =
  \frac{x_{upper} + x_{lower}}{2}\,,\] we consider two intervals:
  $[x_{lower}, x_{mid}]$ and $[x_{mid}, x_{upper}]$.  At least one of
  the following is true:
  \begin{enumerate}
  \item $x_{upper} - x_{right} < \varepsilon$, for some small epsilon (\eg, $\varepsilon = 0.00001$),
    then we know the root is $x_{mid} \pm \varepsilon$, which is good enough.
  \item $P(x_{mid}) = 0$, then we know the root $x= x_{mid}$.
  \item There is a root in the interval $[x_{lower}, x_{mid}]$, then
    we repeat step~\ref{step.4} on the intveral $[x_{lower},
      x_{mid}]$.
  \item There is a root in the interval $[x_{mid}, x_{upper}]$, then
    we repeat step~\ref{step.4} on the interval $[x_{mid},
      x_{upper}]$.
  \end{enumerate}
\end{enumerate}


How does step~\ref{step.2} work?  Start with  $x_{upper}=1$, and query whether ${P(x_{upper}) < 0}$.
If so, then double $x_{upper}$ and try again, until ${P(x_{upper}) > 0}$.  As an example with the polynomial in Figure~\ref{fig.cubic.binary}, we would try ${P(1)< 0}$, ${P(2) < 0}$, ${P(4)<0}$, and finally ${P(8) > 0}$.

Similarly for step~\ref{step.3}?  Start with  $x_{upper}=-1$, and query whether ${P(x_{lower}) > 0}$.
If so, then double $x_{upper}$ and try again, until ${P(x_{upper}) < 0}$.
